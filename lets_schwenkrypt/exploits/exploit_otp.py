import sys
from gameserver import GameServer
from cryptostuff import encryptOTP

PORT = 4711


if __name__ == "__main__":
    assert len(sys.argv) >= 3, "Needs flag ids in third argument"
    target = sys.argv[1]
    flagIds = sys.argv[2].split(",")

    for flagId in flagIds:
        cipher, params = GameServer.retrieveCipher(target, PORT, flagId)
        if params["method"] == "otp":
            plain = encryptOTP(cipher, params).decode("utf-8")
            print(plain)