SchlossbergCaves Exploits
====================

Please also read [these writeups](https://ctftime.org/task/10784)!

There were 5 intended vulnerabilities:
- Path traversal in imports
- New array were not initialized and could leak memory
- Casting byte arrays to int array allow out-of-bounds read/write
- The type of `main()` is not checked
- Symbols can be redefined in different functions with different type, allowing elegant writes to PLT

The last 3 exploits give RCE.
 

There are at least two more exploits for this service:
- Integer overflow in array size: [https://abiondo.me/2020/03/22/saarctf20-schlossberg/#bug-2-integer-overflow-in-array-size](https://abiondo.me/2020/03/22/saarctf20-schlossberg/#bug-2-integer-overflow-in-array-size)
- The session IDs were not random enough (using libc's rand)


Some players thought that this service can be solved with clever programming (creating paths that traverse all possible fields).
This is not that easy because the service gives you a treasure only if you end on the correct field.